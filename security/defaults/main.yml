# Fail2ban Configuration
fail2ban_bantime: "30m"
fail2ban_findtime: "10m"
fail2ban_maxretry: 5
fail2ban_ssh_maxretry: 3
fail2ban_ssh_bantime: 600

# Unattended Upgrades Configuration
unattended_upgrades_reboot: true
unattended_upgrades_reboot_time: "02:00"
unattended_upgrades_remove_unused: true
unattended_upgrades_reboot_with_users: true

# Auto Upgrades Configuration
auto_upgrades_update_interval: "1"
auto_upgrades_download_interval: "1"
auto_upgrades_upgrade_interval: "1"
auto_upgrades_autoclean_interval: "7"

# Password Quality Configuration
pwquality_minlen: 10
pwquality_dcredit: -1   # Must have at least 1 digit (0-9)
pwquality_ucredit: -1   # Must have at least 1 Uppercase (A-Z)
pwquality_lcredit: -1   # Must have at least 1 Lowercase (a-z)
pwquality_ocredit: -1   # Must have at least 1 Symbol (!@#$)
pwquality_usercheck: 1  # Deny passwords that contain the username

# UFW Ports Configuration
ufw_allowed_ports:
  - { rule: 'allow', port: "{{ ssh_new_port }}", proto: 'tcp' }  # SSH
  - { rule: 'allow', port: 80, proto: 'tcp' }  # HTTP
  - { rule: 'allow', port: 443, proto: 'tcp' }  # HTTPS
  - { rule: 'allow', port: 123, proto: 'udp' }  # NTP
  - { rule: 'deny', port: 22, proto: 'tcp' }  # Old SSH Port

# SSH Configuration Options
ssh_new_port: 2222
ssh_address_family: "any"  # any, inet (IPv4), inet6 (IPv6)
ssh_permit_root_login: no
ssh_password_authentication: no
ssh_pubkey_authentication: yes
ssh_max_auth_tries: 3
ssh_log_level: "VERBOSE" # QUIET, FATAL, ERROR, INFO, VERBOSE, DEBUG, DEBUG1, DEBUG2, DEBUG3
ssh_allow_tcp_forwarding: no
ssh_allow_agent_forwarding: no
ssh_x11_forwarding: no
ssh_print_motd: no
ssh_use_dns: no
ssh_client_alive_count_max: 2
ssh_max_sessions: 2

# SELinux Configuration
selinux_state: "enforcing"   #  "enforcing" (block violations), "permissive" (log only), "disabled"
selinux_policy: "targeted"     # "default", "targeted", "mls"
selinux_httpd_can_network_connect: yes # allow httpd/apache to make network connections (for reverse proxy, API calls, etc.)

# Kernel Config
kernel_net_modules_blocklist: ["atm", "dccp", "sctp", "rds", "tipc"]
kernel_fs_modules_blocklist: ["cramfs", "freevxfs", "hfs", "hfsplus", "jffs2", "squashfs", "udf"]
kernel_misc_modules_blocklist:
  - "bluetooth"
  - "bnep"
  - "btusb"
  - "can"
  - "cpia2"
  - "firewire-core"
  - "floppy"
  - "ksmbd"
  - "n_hdlc"
  - "net-pf-31"
  - "pcspkr"
  - "soundcore"
  - "thunderbolt"
  # - "usb-midi"
  # - "usb-storage"
  - "uvcvideo"
  - "v4l2_common"

systemd_resolved_dns: ["1.1.1.1", "8.8.8.8"]
systemd_resolved_fallback_dns: ["1.0.0.1", "8.8.4.4"]

# Maximum number of open files
systemd_limit_nofile_hard: 1024
systemd_limit_nproc_hard: 1024